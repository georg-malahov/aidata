angular.module("app",["ui.grid","ui.grid.edit","ui.grid.autoResize","ui.grid.resizeColumns","ui.grid.moveColumns","ui.grid.saveState","ui.grid.selection","ui.grid.exporter","ui.grid.pinning","ui.bootstrap"]).config(["$interpolateProvider",function(e){return e.startSymbol("[["),e.endSymbol("]]")}]).run(["$rootScope",function(e){return e.preloading={page:!0}}]),angular.module("app").controller("MainController",["$scope","$rootScope","$modal","$window",function(e,t,r,i){return t.preloading.page=!1,e.openModal=function(t){var i;return i=r.open({templateUrl:"modal.html",controller:"ModalController",size:t,resolve:{items:function(){return e.items}}}),i.result.then(function(t){return e.selected=t},function(){return void 0})},i.__pixels.length?void 0:e.openModal("lg")}]),angular.module("app").controller("ModalController",["$scope","$rootScope","$modalInstance","$window",function(e,t,r,i){return e.customers=i.__customers,e.currencies=i.__currencies,e.pixel=t.editedPixel||{},e.defaultOption={"new":1,customer:{type:"1",id:""},cpm:{currency:"USD",cost:""}},e.getDefaultOption=function(){var t;return t=angular.fromJson(angular.toJson(e.defaultOption))},e.pixelOptions=e.pixel.options||[e.getDefaultOption()],e.ok=function(){return r.close()},e.cancel=function(){return r.dismiss("cancel")}}]),angular.module("app").controller("TableController",["$scope","$rootScope","$filter","$timeout","$interpolate","$window","ColumnsService",function(e,t,r,i,n,o,l){var a;return e.gridScope={},e.startSym=n.startSymbol(),e.endSym=n.endSymbol(),a="Select at least one pixel from the table.",e.editPixelTooltip=a,e.preloading.page=!1,e.gridOptions={saveScroll:!1,saveFilter:!1,saveFocus:!1,saveRowIdentity:!1,saveSelection:!1,enableGridMenu:!0,showGridFooter:!1,showColumnFooter:!1,multiSelect:!1,data:o.__pixels,columnDefs:l,onRegisterApi:function(r){var i;return e.gridApi=r,i=o.__pixels.length,50>=i?angular.element(document.getElementsByClassName("tablegrid_grid")[0]).css("height",30*i+45+"px"):angular.element(document.getElementsByClassName("tablegrid_grid")[0]).css("height","1545px"),r.selection.on.rowSelectionChanged(e,function(){var i;return i=r.selection.getSelectedGridRows(),void(i.length?(t.editedPixel=i[0].entity,e.editPixelTooltip=""):(t.editedPixel=!1,e.editPixelTooltip=a))})}}}]),angular.module("app").directive("tablecontrolPreview",["$rootScope","$timeout",function(e){return{restrict:"CA",link:function(t,r){var i;return r.popover({html:!0,container:"body",content:function(){var t,r;return r="",e.editedPixel&&(r=e.editedPixel.pixel_id),t="<img src='http://advombat.ru/0.gif?pid="+r+"' width='0px' height='0px'/>",'<textarea class="form-control" readonly onclick="this.focus();this.select()">'+t+"</textarea>"},placement:"right",trigger:"click"}),i=function(e){return jQuery(e.target).parents(".popover").length?void 0:r.popover("hide")},r.on("shown.bs.popover",function(){return jQuery("body").bind("click",i)}),r.on("hidden.bs.popover",function(){return jQuery("body").unbind("click")})}}}]),angular.module("app").directive("pixelCreateForm",["$rootScope","$timeout",function(e,t){return{restrict:"CA",link:function(r,i){var n;return n=function(){return i.formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{id:{validators:{notEmpty:{message:"Pixel ID is required"},regexp:{regexp:/^[\d|\w|\-|\_]*$/i,message:'Pixel ID can consist of alphabetical and digital characters as well ad "-" and "_" symbols only'}}},name:{validators:{notEmpty:{message:"Pixel Name is required"},stringLength:{min:3,max:255,trim:!0,message:"Pixel Name must be more then 3 and less than 255 characters"}}}}})},t(function(){return n()},100),e.resetForm=function(){return i.data("formValidation").resetForm()},e.updateForm=function(){return i.data("formValidation").destroy(),t(function(){return n()},100)},i.find(".sharing-options_add").click(function(){return t(function(){var e;return e=jQuery(".sharing-option").last().find(".form-control"),angular.forEach(e,function(e){return i.data("formValidation").addField(jQuery(e))})},100)}),i.find(".sharing-option_action__trash").click(function(){return t(function(){var e;return e=jQuery(".sharing-option").last().find(".form-control"),angular.forEach(e,function(e){return i.data("formValidation").removeField(jQuery(e))})},100)})}}}]),angular.module("app").factory("ColumnsService",function(){return[{field:"pixel_id",displayName:"Pixel ID",cellClass:"to-left",headerCellClass:"to-left",minWidth:100,width:"*"},{field:"status",displayName:"Status",cellClass:"to-left",headerCellClass:"to-left",minWidth:100,width:"*"},{field:"name",displayName:"Name",cellClass:"to-left",headerCellClass:"to-left",minWidth:100,width:"*"},{field:"size",displayName:"Size",cellClass:"to-right",headerCellClass:"center",cellFilter:"number",minWidth:100},{field:"created",displayName:"Created",cellClass:"center",headerCellClass:"center",cellFilter:'date : "yyyy-MM-dd HH:mm"',minWidth:100}]}),angular.bootstrap(document,["app"]);